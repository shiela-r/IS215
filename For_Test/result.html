<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>News Report</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }

    @keyframes fade-in {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate-fade-in {
      animation: fade-in 0.6s ease-out both;
    }
  </style>
</head>
<body class="bg-blue-100 min-h-screen flex items-center justify-center px-4 py-10">

  <div class="bg-white rounded-2xl shadow-lg max-w-2xl w-full p-6 sm:p-8 space-y-6 animate-fade-in border border-blue-200">
    <header class="space-y-1">
      <h1 class="text-3xl font-bold text-blue-800" id="title">Generated News Article</h1>
      <div class="text-sm text-gray-500">
        Uploaded by <span class="font-medium text-gray-700" id="authorName">Anonymous</span> â€¢ <span id="dateNow">Today</span>
      </div>
    </header>

    <div class="w-full">
      <img src="https://via.placeholder.com/600x300" alt="News Thumbnail"
        class="rounded-xl border border-blue-200 shadow-md w-full object-cover">
    </div>

    <article class="text-gray-700 leading-relaxed text-justify space-y-4" id="articleContent">
      <p>Loading article...</p>
    </article>

    <div class="pt-4 text-center">
      <a href="index.html" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-3 rounded-xl transition duration-300 shadow-sm">
        Back to Upload
      </a>
    </div>
  </div>

  <script>
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    async function loadArticle() {
      const filename = getQueryParam("filename");
      if (!filename) {
        document.getElementById("articleContent").innerHTML = "<p>Error: No filename specified.</p>";
        return;
      }

      const txtFilename = filename.split('.')[0] + ".txt";
      const articlePath = `https://is-215-project.s3.amazonaws.com/articles/${txtFilename}`; 

      try {
        const response = await fetch(articlePath);
        if (!response.ok) throw new Error("Article not found");

        const text = await response.text();
        document.getElementById("articleContent").innerHTML = text
          .split('\n\n')
          .map(p => `<p>${p}</p>`)
          .join('');
        
        // Set author name if provided (you may pass it through query param too)
        const name = getQueryParam("name");
        if (name) {
          document.getElementById("authorName").textContent = decodeURIComponent(name);
        }

        // Set date
        document.getElementById("dateNow").textContent = new Date().toLocaleDateString();

      } catch (err) {
        document.getElementById("articleContent").innerHTML = `<p class="text-red-600">Error loading article: ${err.message}</p>`;
      }
    }

    loadArticle();
  </script>
</body>
</html>
